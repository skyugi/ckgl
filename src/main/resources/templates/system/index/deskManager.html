<!DOCTYPE html>
<html style="height: 100%" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8">
	<title>首页--layui后台管理模板 2.0</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="stylesheet" href="/resources/layui/css/layui.css" media="all" />
	<link rel="stylesheet" href="/resources/css/public.css" media="all" />
</head>
<body class="childrenBody" style="height: 100%; margin: 0">
	<blockquote class="layui-elem-quote layui-bg-black" style="text-align: center;display: none">
		<div id="nowTime" style="text-align: center"></div>
	</blockquote>
	<div class="layui-row layui-col-space10 panel_box">
		<div class="panel layui-col-xs12 layui-col-sm6 layui-col-md4 layui-col-lg2">
			<a href="javascript:;" data-url="http://fly.layui.com/case/u/3198216" target="_blank">
				<div class="panel_icon layui-bg-green">
					<i class="layui-anim seraph icon-good"></i>
				</div>
				<div class="panel_word">
					<span>Homepage</span>
<!--					<span>为我点赞</span>-->
<!--					<cite>点赞地址链接</cite>-->
					<cite>首页看板</cite>
				</div>
			</a>
		</div>
		<div class="panel layui-col-xs12 layui-col-sm6 layui-col-md4 layui-col-lg2">
			<a href="javascript:;" data-url="https://github.com/BrotherMa/layuicms2.0" target="_blank">
				<div class="panel_icon layui-bg-black">
					<i class="layui-anim seraph icon-github"></i>
				</div>
				<div class="panel_word">
					<span>Github</span>
<!--					<cite>模版下载链接</cite>-->
					<cite>托管网站</cite>
				</div>
			</a>
		</div>
		<div class="panel layui-col-xs12 layui-col-sm6 layui-col-md4 layui-col-lg2">
			<a href="javascript:;" data-url="https://gitee.com/layuicms/layuicms2.0" target="_blank">
				<div class="panel_icon layui-bg-red">
					<i class="layui-anim seraph icon-oschina"></i>
				</div>
				<div class="panel_word">
					<span>Git</span>
<!--					<cite>模版下载链接</cite>-->
					<cite>版本控制</cite>
				</div>
			</a>
		</div>
		<div class="panel layui-col-xs12 layui-col-sm6 layui-col-md4 layui-col-lg2">
			<a href="javascript:;" data-url="page/user/userList.html">
				<div class="panel_icon layui-bg-orange">
					<i class="layui-anim seraph icon-icon10" data-icon="icon-icon10"></i>
				</div>
				<div class="panel_word userAll">
					<span>666</span>
					<em>用户总数</em>
					<cite class="layui-hide">用户中心</cite>
				</div>
			</a>
		</div>
		<div class="panel layui-col-xs12 layui-col-sm6 layui-col-md4 layui-col-lg2">
			<a href="javascript:;" data-url="page/systemSetting/icons.html">
				<div class="panel_icon layui-bg-cyan">
					<i class="layui-anim layui-icon" data-icon="&#xe857;">&#xe857;</i>
				</div>
				<div class="panel_word outIcons">
					<span></span>
					<em>外部图标</em>
					<cite class="layui-hide">图标管理</cite>
				</div>
			</a>
		</div>
		<div class="panel layui-col-xs12 layui-col-sm6 layui-col-md4 layui-col-lg2">
			<a href="javascript:;">
				<div class="panel_icon layui-bg-blue">
					<i class="layui-anim seraph icon-clock"></i>
				</div>
				<div class="panel_word">
					<span class="loginTime"></span>
					<cite>上次登录时间</cite>
				</div>
			</a>
		</div>
	</div>
	<div class="layui-row layui-col-space10" style="height: 100%">
		<div class="layui-col-lg6 layui-col-md12" style="height: 100%">
			<blockquote class="layui-elem-quote title">系统基本参数</blockquote>
			<table class="layui-table magt0">
				<colgroup>
					<col width="150">
					<col>
				</colgroup>
				<tbody>
				<tr>
					<td>当前版本</td>
					<td class="version">v1.0</td>
				</tr>
				<tr>
					<td>开发作者</td>
					<td class="author">刘样</td>
				</tr>
<!--				<tr>-->
<!--					<td>网站首页</td>-->
<!--					<td class="homePage"></td>-->
<!--				</tr>-->
<!--				<tr>-->
<!--					<td>服务器环境</td>-->
<!--					<td class="server"></td>-->
<!--				</tr>-->
				<tr>
					<td>数据库版本</td>
					<td class="dataBase">MySQL5.7</td>
				</tr>
<!--				<tr>-->
<!--					<td>最大上传限制</td>-->
<!--					<td class="maxUpload"></td>-->
<!--				</tr>-->
<!--				<tr>-->
<!--					<td>当前用户权限</td>-->
<!--					<td class="userRights"></td>-->
<!--				</tr>-->
				</tbody>
			</table>
<!--			<blockquote class="layui-elem-quote title">最新文章 <i class="layui-icon layui-red">&#xe756;</i></blockquote>-->
<!--			<blockquote class="layui-elem-quote title">角色统计 <i class="layui-icon layui-red"></i></blockquote>-->
<!--			<table class="layui-table mag0" lay-skin="line">-->
<!--				<colgroup>-->
<!--					<col>-->
<!--					<col width="110">-->
<!--				</colgroup>-->
<!--				<tbody class="hot_news"></tbody>-->
<!--			</table>-->
			<div style="height: 100%">
				<div id="container1" style="height: 100%"></div>
			</div>
		</div>
		<div class="layui-col-lg6 layui-col-md12" style="height: 100%">
<!--			<blockquote class="layui-elem-quote title">发展历程&更新日志</blockquote>-->
<!--			<blockquote class="layui-elem-quote title">部门比例</blockquote>-->
<!--			<div class="layui-elem-quote layui-quote-nm history_box magb0">-->
<!--				<ul class="layui-timeline">-->
<!--					<li class="layui-timeline-item">-->
<!--						<i class="layui-icon layui-timeline-axis">&#xe756;</i>-->
<!--						<div class="layui-timeline-content layui-text">-->
<!--							<div class="layui-timeline-title">-->
<!--								<h3 class="layui-inline">layuiCMS 里程碑版本<span class="layui-red">layuiCMS2.0基础版</span>发布　</h3>-->
<!--								<span class="layui-badge-rim">2018-01-31</span>-->
<!--							</div>-->

<!--						</div>-->
<!--					</li>-->
<!--					<li class="layui-timeline-item">-->
<!--						<i class="layui-icon layui-timeline-axis">&#xe63f;</i>-->
<!--						<div class="layui-timeline-content layui-text">-->
<!--							<div class="layui-timeline-title">-->
<!--								<h3 class="layui-inline">结合大家需求并修改部分bug后形成的layuiCMS V1.0.1发布　</h3>-->
<!--								<span class="layui-badge-rim">2017-07-05</span>-->
<!--							</div>-->
<!--						</div>-->
<!--					</li>-->
<!--					<li class="layui-timeline-item">-->
<!--						<i class="layui-icon layui-timeline-axis">&#xe63f;</i>-->
<!--						<div class="layui-timeline-content layui-text">-->
<!--							<div class="layui-timeline-title">-->
<!--								<h3 class="layui-inline">layuiCMS V1.0正式与大家见面，提供了一些简单功能　</h3>-->
<!--								<span class="layui-badge-rim">2017-06-21</span>-->
<!--							</div>-->
<!--						</div>-->
<!--					</li>-->
<!--				</ul>-->
<!--			</div>-->
			<div style="height: 100%">
				<div id="container2" style="height: 100%;width: 100%"></div>
			</div>
		</div>
	</div>

	<script type="text/javascript" src="/resources/layui/layui.js"></script>
<!--	<script type="text/javascript" src="/resources/js/main.js"></script>-->
	<script type="text/javascript" src="/resources/echarts/js/echarts.min.js"></script>
	<script type="text/javascript" src="/resources/echarts/js/jquery-3.1.1.min.js"></script>
	<script>
		//获取当前登录人
		var currentUserName='[[${session.user.name}]]';

		//获取系统时间
		var newDate = '';
		getLangDate();
		//值小于10时，在前面补0
		function dateFilter(date){
			if(date < 10){return "0"+date;}
			return date;
		}
		function getLangDate(){
			var dateObj = new Date(); //表示当前系统时间的Date对象
			var year = dateObj.getFullYear(); //当前系统时间的完整年份值
			var month = dateObj.getMonth()+1; //当前系统时间的月份值
			var date = dateObj.getDate(); //当前系统时间的月份中的日
			var day = dateObj.getDay(); //当前系统时间中的星期值
			var weeks = ["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];
			var week = weeks[day]; //根据星期值，从数组中获取对应的星期字符串
			var hour = dateObj.getHours(); //当前系统时间的小时值
			var minute = dateObj.getMinutes(); //当前系统时间的分钟值
			var second = dateObj.getSeconds(); //当前系统时间的秒钟值
			var timeValue = "" +((hour >= 12) ? (hour >= 18) ? "晚上" : "下午" : "上午" ); //当前时间属于上午、晚上还是下午
			newDate = dateFilter(year)+"年"+dateFilter(month)+"月"+dateFilter(date)+"日 "+" "+dateFilter(hour)+":"+dateFilter(minute)+":"+dateFilter(second);
			document.getElementById("nowTime").innerHTML = "亲爱的【"+currentUserName+"】，"+timeValue+"好！ 欢迎使用韦恩医药进销存管理系统。当前时间为： "+newDate+"　"+week;
			setTimeout("getLangDate()",1000);
		}

		layui.use(['form','element','layer','jquery'],function(){
			var form = layui.form,
					layer = parent.layer === undefined ? layui.layer : top.layer,
					element = layui.element;
			$ = layui.jquery;
			//上次登录时间【此处应该从接口获取，实际使用中请自行更换】
			$(".loginTime").html(newDate.split("日")[0]+"日</br>"+newDate.split("日")[1]);
			//icon动画
			$(".panel a").hover(function(){
				$(this).find(".layui-anim").addClass("layui-anim-scaleSpring");
			},function(){
				$(this).find(".layui-anim").removeClass("layui-anim-scaleSpring");
			})
			$(".panel a").click(function(){
				parent.addTab($(this));
			})
			//系统基本参数
			if(window.sessionStorage.getItem("systemParameter")){
                var systemParameter = JSON.parse(window.sessionStorage.getItem("systemParameter"));
                fillParameter(systemParameter);
            }else{
                $.ajax({
                    url : "../json/systemParameter.json",
                    type : "get",
                    dataType : "json",
                    success : function(data){
                        fillParameter(data);
                    }
                })
            }
			//填充数据方法
			function fillParameter(data){
                //判断字段数据是否存在
                function nullData(data){
                    if(data == '' || data == "undefined"){
                        return "未定义";
                    }else{
                        return data;
                    }
                }
                $(".version").text(nullData(data.version));      //当前版本
                $(".author").text(nullData(data.author));        //开发作者
                $(".homePage").text(nullData(data.homePage));    //网站首页
                $(".server").text(nullData(data.server));        //服务器环境
                $(".dataBase").text(nullData(data.dataBase));    //数据库版本
                $(".maxUpload").text(nullData(data.maxUpload));    //最大上传限制
                $(".userRights").text(nullData(data.userRights));//当前用户权限
            }

			//最新文章列表
			$.get("/resources/json/newsList.json",function(data){
				var hotNewsHtml = '';
				for(var i=0;i<5;i++){
					hotNewsHtml += '<tr>'
							+'<td align="left"><a href="javascript:;"> '+data.data[i].newsName+'</a></td>'
							+'<td>'+data.data[i].newsTime.substring(0,10)+'</td>'
							+'</tr>';
				}
				$(".hot_news").html(hotNewsHtml);
				$(".userAll span").text(data.length);
			})

			//用户数量
			$.get("../json/userList.json",function(data){
                $(".userAll span").text(data.count);
            })

			//外部图标
			$.get(iconUrl,function(data){
                $(".outIcons span").text(data.split(".icon-").length-1);
            })

		})






		$.get("/stat/queryRoleNameStatJson",function (data) {
			var dom = document.getElementById("container1");
			var myChart = echarts.init(dom);
			var app = {};
			option = null;
			option = {
				title: {
					text: '角色/职位',
					subtext: '有效在用',
					left: 'center'
				},
				tooltip: {
					trigger: 'item',
					formatter: '{a} <br/>{b} : {c} ({d}%)'
				},
				legend: {
					orient: 'vertical',
					left: 'left',
					data: data
				},
				series: [
					{
						name: '角色数量(占比)',
						type: 'pie',
						radius: '55%',
						center: ['50%', '60%'],
						data: data,
						emphasis: {
							itemStyle: {
								shadowBlur: 10,
								shadowOffsetX: 0,
								shadowColor: 'rgba(0, 0, 0, 0.5)'
							}
						}
					}
				]
			};
			;
			if (option && typeof option === "object") {
				myChart.setOption(option, true);
			}
		});


		$.get("/stat/queryDeptEmployeeNumStatJson", function (data) {
			var dom = document.getElementById("container2");
			var myChart = echarts.init(dom);
			var app = {};
			option = null;
			option = {
				title : {
					text: '各部门人数',
					subtext: '单位/人',
					x:'left'
				},
				color: ['#3398DB'],
				tooltip: {
					trigger: 'axis',
					axisPointer: {            // 坐标轴指示器，坐标轴触发有效
						type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
					}
				},
				grid: {
					left: '3%',
					right: '4%',
					bottom: '3%',
					containLabel: true
				},
				xAxis: [
					{
						type: 'category',
						data: data.name,
						axisLabel: {
							interval:0, //代表显示所有x轴标签显示
							rotate:45   //代表逆时针旋转45度
						},
						axisTick: {
							alignWithLabel: true
						}
					}
				],
				yAxis: [
					{
						type: 'value'
					}
				],
				series: [
					{
						name: '人数(占比)',
						type: 'bar',
						barWidth: '60%',
						data: data.value
					}
				]
			};
			;
			if (option && typeof option === "object") {
				myChart.setOption(option, true);
			}
		});
	</script>
</body>
</html>